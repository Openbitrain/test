import axios from 'axios';
import { HttpsProxyAgent } from 'https-proxy-agent';

// proxyList as strings "ip:port"
const proxyList = [
    "154.194.12.109:80",
    "184.168.47.48:80",
    "154.194.12.199:80",
    "45.131.7.144:80",
    "184.168.47.25:80",
    "154.194.12.62:80",
    "154.194.12.185:80",
    "184.168.47.109:80",
    "93.190.138.107:46182",
    "184.168.47.80:80",
    "162.159.242.77:80",
    "184.168.47.72:80",
    "23.237.210.82:80",
    "67.43.236.18:32557",
    "154.194.12.69:80",
    "45.14.165.47:8080",
    "67.43.228.252:13509",
    "113.172.107.128:1002",
    "154.194.12.12:80",
    "104.18.40.102:80",
    "167.160.89.37:8080",
    "47.56.110.204:8989",
    "210.206.242.131:5031",
    "67.43.228.250:9873",
    "154.194.12.244:80",
    "172.67.161.223:80",
    "85.215.64.49:80",
    "5.10.244.54:80",
    "206.238.239.88:80",
    "154.194.12.32:80",
    "184.168.47.41:80",
    "188.166.154.164:8118",
    "184.168.47.222:80",
    "185.221.160.24:80",
    "184.168.47.49:80",
    "184.168.47.253:80",
    "91.193.59.160:80",
    "5.255.124.247:80",
    "45.80.111.167:80",
    "212.183.88.179:80",
    "45.131.208.196:80",
    "104.20.175.209:80",
    "138.91.159.185:80",
    "185.193.31.255:80",
    "91.103.120.55:80",
    "154.194.12.67:80",
    "198.23.143.74:80",
    "113.108.13.120:4433",
    "185.148.104.71:80",
    "218.77.183.214:5224",
    "119.3.113.150:9094",
    "57.129.81.201:3128",
    "152.228.154.20:80",
    "34.210.14.70:80",
    "46.173.208.61:1194",
    "8.219.97.248:80",
    "185.148.105.63:80",
    "38.191.203.243:999",
    "185.148.104.44:80",
    "156.251.62.23:8118",
    "14.241.80.37:8080",
    "8.209.255.13:3128",
    "206.238.238.10:80",
    "184.168.47.11:80",
    "138.68.235.51:80",
    "14.235.225.181:29075",
    "223.205.76.47:8080",
    "184.168.47.9:80",
    "98.64.128.182:3128",
    "103.36.11.119:8181",
    "45.131.209.175:80",
    "184.168.47.224:80",
    "185.105.102.189:80",
    "180.191.36.128:8181",
    "142.93.202.130:3128",
    "184.168.47.15:80",
    "103.81.194.167:8080",
    "34.87.109.175:443",
    "203.190.44.121:2202",
    "79.121.102.227:8080",
    "154.194.12.239:80",
    "103.177.199.61:1111",
    "103.82.38.226:8888",
    "31.12.75.138:80",
    "113.192.31.199:8080",
    "172.67.170.14:80",
    "154.194.12.19:80",
    "156.251.62.129:8118",
    "185.162.228.207:80",
    "103.80.214.3:8080",
    "34.87.84.105:80",
    "172.67.231.45:80",
    "185.191.236.162:3128",
    "40.76.69.94:8080",
    "13.212.95.135:8000",
    "80.249.112.166:80",
    "38.7.18.156:999",
    "45.159.218.142:80",
    "123.30.154.171:7777",
    "57.129.81.201:8081",
    "216.205.52.208:80",
    "190.61.45.71:999",
    "120.89.91.194:8085",
    "103.156.74.157:8080",
    "20.13.148.109:8080",
    "103.156.248.12:8080",
    "5.10.245.202:80",
    "45.12.150.82:8080",
    "31.146.116.18:8080",
    "60.187.244.66:8085",
    "181.188.238.144:999",
    "179.60.53.28:999",
    "114.230.209.31:3712",
    "77.75.95.14:80",
    "185.174.138.118:80",
    "113.192.48.36:8090",
    "43.133.136.208:8800",
    "103.68.214.123:8080",
    "5.10.245.209:80",
    "163.223.78.97:8080",
    "133.18.234.13:80",
    "34.102.48.89:8080",
    "103.186.12.14:8080",
    "38.52.158.68:999",
    "192.203.0.254:999",
    "46.161.194.86:8085",
    "198.145.118.52:8080",
    "103.203.232.212:3125",
    "184.168.47.142:80",
    "200.174.198.86:8888",
    "103.81.194.161:8080",
    "157.15.82.116:8113",
    "160.22.134.3:1111",
    "84.103.174.6:80",
    "38.49.129.205:999",
    "45.159.217.207:80",
    "129.151.241.80:8080",
    "184.168.47.101:80",
    "185.176.24.63:80",
    "124.121.94.250:8080",
    "116.212.149.218:8080",
    "46.243.3.7:8118",
    "91.193.59.158:80",
    "103.163.36.228:8081",
    "89.116.250.82:80",
    "94.139.204.51:8081",
    "103.160.182.103:8080",
    "201.62.125.142:8080",
    "177.53.212.177:8080",
    "201.77.96.0:999",
    "184.168.47.146:80",
    "184.168.47.37:80",
    "184.168.47.137:80",
    "103.144.253.234:8080",
    "150.95.26.146:7080",
    "98.154.21.253:4228",
    "156.218.193.140:8080",
    "104.27.4.87:80",
    "66.81.247.227:80",
    "104.17.104.74:80",
    "185.235.16.12:80",
    "170.114.46.174:80",
    "51.255.36.182:80",
    "149.86.144.51:8080",
    "184.168.47.238:80",
    "103.126.87.112:1285",
    "125.77.135.240:80",
    "178.66.126.6:8080",
    "103.175.237.232:3128",
    "172.67.167.202:80",
    "104.237.250.13:80",
    "47.238.134.126:14",
    "117.102.81.4:53281",
    "156.251.62.25:8118",
    "184.168.47.10:80",
    "212.183.88.191:80",
    "103.247.13.238:8080",
    "184.168.47.231:80",
    "181.214.1.252:80",
    "184.168.47.3:80",
    "115.245.89.250:8080",
    "102.164.215.198:8080",
    "38.250.126.201:999",
    "184.168.47.181:80",
    "2.50.48.110:8080",
    "47.238.134.126:6379",
    "66.235.200.206:80",
    "103.14.231.218:3168",
    "118.172.184.25:8180",
    "160.248.7.177:80",
    "168.138.50.91:80",
    "47.79.16.186:3128",
    "38.194.245.229:3128",
    "67.43.236.22:22847",
    "184.168.47.140:80",
    "66.201.7.151:3128",
    "202.148.14.196:8050",
    "20.78.118.91:8561",
    "194.152.44.164:80",
    "101.255.165.214:3125",
    "27.79.167.20:16000",
    "49.49.89.240:8081",
    "188.227.140.181:8080",
    "185.148.106.129:80",
    "185.4.229.132:8080",
    "38.52.158.155:999",
    "216.24.57.89:80",
    "162.159.242.154:80",
    "188.166.230.109:31028",
    "57.129.81.201:999",
    "181.214.1.21:80",
    "103.88.229.59:8080",
    "45.12.31.186:80",
];


// Test a single proxy
async function testProxy(proxyStr) {
    const proxyUrl = `http://${proxyStr}`;
    const agent = new HttpsProxyAgent(proxyUrl);

    try {
        const response = await axios.get('https://api.ipify.org?format=json', {
            httpsAgent: agent,
            timeout: 5000,
        });
        console.log(`✅ Proxy ${proxyUrl} works. IP detected: ${response.data.ip}`);
        return true;
    } catch (error) {
        console.log(`❌ Proxy ${proxyUrl} failed: ${error.message}`);
        return false;
    }
}

(async () => {
    for (const proxy of proxyList) {
        await testProxy(proxy);
    }
})();
